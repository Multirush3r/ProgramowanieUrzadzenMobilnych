<!DOCTYPE html>
<html>
  <head> </head>
  <body>
    <canvas></canvas>
    <script>
      let canvas = document.querySelector("canvas");
      let c = canvas.getContext("2d");

      canvas.width = 800;
      canvas.height = 600;
      canvas.style.border = "1px solid black";

      function getDistance(x1, y1, x2, y2) {
        let xDist = x2 - x1;
        let yDist = y2 - y1;

        return Math.sqrt(Math.pow(xDist, 2) + Math.pow(yDist, 2));
      }

      function Stair(x, y, width, height) {
        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;

        this.draw = function () {
          c.beginPath();
          c.rect(this.x, this.y, this.width, this.height);
          c.strokeStyle = "red";
          c.fillStyle = "red";
          c.fill();
          c.stroke();
        };
      }

      function Ball(x, y, dx, dy, radius, stairsArray) {
        this.x = x;
        this.y = y;
        this.dx = dx;
        this.dy = dy;
        this.radius = radius;

        this.draw = function () {
          c.beginPath();
          c.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);
          c.strokeStyle = "blue";
          c.fillStyle = "blue";
          c.fill();
          c.stroke();
        };

        this.update = function () {
          if (this.x + this.radius > 800 || this.x - this.radius < 0) {
            this.dx = -this.dx;
          }

          stairsArray.forEach((element) => {
            console.log(
              getDistance(
                element.x,
                element.y,
                this.x + this.radius,
                this.y + this.radius
              )
            );
            if (
              this.y + this.radius >
              getDistance(element.x, element.y, this.x, this.y)
            ) {
              this.dy = -this.dy;
            } else {
              this.dy += 0.5;
            }
          });

          this.dy += 0.5;
          this.x += this.dx;
          this.y += this.dy;

          this.draw();
        };
      }

      let stairsArray = [];
      for (let i = 0; i < 5; i++) {
        stairsArray.push(new Stair(i * 100, 100 + i * 100, 100, 500 - i * 100));
      }

      let ball = new Ball(100, 100, 0.2, 0.2, 25, stairsArray);

      function animation() {
        requestAnimationFrame(animation);
        c.clearRect(0, 0, 800, 600);
        for (let i = 0; i < stairsArray.length; i++) {
          stairsArray[i].draw();
        }
        ball.update();
      }

      animation();
    </script>
  </body>
</html>
